--- entrance/data/config/build_config.sh.in	2004-04-11 00:23:16.000000000 +0200
+++ entrance/data/config/build_config.sh.in.new	2005-01-08 15:49:36.768610184 +0100
@@ -1,5 +1,5 @@
 #!/bin/sh -e
-DB="./entrance_config.db"
+DB="/var/lib/entrance/entrance_config.db"
 rm -f $DB
 
 # set auth to 1 for pam, 2 for shadow
@@ -19,31 +19,22 @@
 #edb_ed $DB add /entrance/fonts/1/str str "/usr/X11R6/lib/X11/fonts/Truetype/"
 edb_ed $DB add /entrance/greeting/before str "Welcome to "
 edb_ed $DB add /entrance/greeting/after str ""
-edb_ed $DB add /entrance/session/count int 8
-edb_ed $DB add /entrance/session/0/session str "default"
-edb_ed $DB add /entrance/session/0/title str "Default"
-edb_ed $DB add /entrance/session/0/icon str "default.png"
-edb_ed $DB add /entrance/session/1/icon str "enlightenment.png"
-edb_ed $DB add /entrance/session/1/title str "Enlightenment"
-edb_ed $DB add /entrance/session/1/session str "Enlightenment"
-edb_ed $DB add /entrance/session/2/session str "kde"
-edb_ed $DB add /entrance/session/2/title str "KDE"
-edb_ed $DB add /entrance/session/2/icon str "kde.png"
-edb_ed $DB add /entrance/session/3/session str "gnome"
-edb_ed $DB add /entrance/session/3/title str "Gnome"
-edb_ed $DB add /entrance/session/3/icon str "gnome.png"
-edb_ed $DB add /entrance/session/4/session str "blackbox"
-edb_ed $DB add /entrance/session/4/title str "Blackbox"
-edb_ed $DB add /entrance/session/4/icon str "blackbox.png"
-edb_ed $DB add /entrance/session/5/session str "sawfish"
-edb_ed $DB add /entrance/session/5/title str "Sawfish"
-edb_ed $DB add /entrance/session/5/icon str "default.png"
-edb_ed $DB add /entrance/session/6/session str "xfce"
-edb_ed $DB add /entrance/session/6/title str "XFce"
-edb_ed $DB add /entrance/session/6/icon str "xfce.png"
-edb_ed $DB add /entrance/session/7/session str "failsafe"
-edb_ed $DB add /entrance/session/7/title str "Failsafe"
-edb_ed $DB add /entrance/session/7/icon str "failsafe.png"
+edb_ed $DB add /entrance/session/count int @COUNT@
+
+# lines starting with ^#session: will be parsed for each .desktop file
+# in /usr/share/xsessions where:
+# @SESSION@	is Exec=(*)
+# @TITLE@	is Name=(*)
+# @ICON@	is entrance icon if exist, or default 
+#			see /usr/share/entrance/images/sessions/
+# everything will by in /tmp/sessions
+
+#session:edb_ed $DB add /entrance/session/@NUM@/session str "@SESSION@"
+#session:edb_ed $DB add /entrance/session/@NUM@/title str "@TITLE@"
+#session:edb_ed $DB add /entrance/session/@NUM@/icon str "@ICON@"
+
+. /tmp/sessions
+
 edb_ed $DB add /entrance/system/reboot int 1
 edb_ed $DB add /entrance/system/halt int 1
 edb_ed $DB add /entrance/user/remember int 1
--- entrance/data/Makefile.am	2003-10-22 13:29:59.000000000 +0200
+++ entrance/data/Makefile.am.new	2005-01-08 15:50:12.962107936 +0100
@@ -1,2 +1,2 @@
-SUBDIRS = config images themes fonts users
+SUBDIRS = images themes fonts users
 
